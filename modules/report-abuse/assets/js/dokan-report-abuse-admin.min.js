!function(e){var t={};function r(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=t,r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=100)}({0:function(e,t){e.exports=function(e,t,r,o,n,s){var a,i=e=e||{},u=typeof e.default;"object"!==u&&"function"!==u||(a=e,i=e.default);var d,l="function"==typeof i?i.options:i;if(t&&(l.render=t.render,l.staticRenderFns=t.staticRenderFns,l._compiled=!0),r&&(l.functional=!0),n&&(l._scopeId=n),s?(d=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),o&&o.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(s)},l._ssrRegister=d):o&&(d=o),d){var c=l.functional,p=c?l.render:l.beforeCreate;c?(l._injectStyles=d,l.render=function(e,t){return d.call(t),p(e,t)}):l.beforeCreate=p?[].concat(p,d):[d]}return{esModule:a,exports:i,options:l}}},1:function(e,t){e.exports=jQuery},100:function(e,t,r){"use strict";var o=function(e){return e&&e.__esModule?e:{default:e}}(r(101));dokan_add_route(o.default)},101:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(30),n=r(104),s=r(0)(o.a,n.a,!1,null,null,null);s.options.__file="modules/report-abuse/src/js/admin/pages/AbuseReports.vue",t.default=s.exports},102:function(e,t,r){"use strict";var o=r(31),n=r(103),s=r(0)(o.a,n.a,!1,null,null,null);s.options.__file="modules/report-abuse/src/js/components/AbuseReasonsDropdown.vue",t.a=s.exports},103:function(e,t,r){"use strict";var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedReason,expression:"selectedReason"}],on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.selectedReason=t.target.multiple?r:r[0]}}},[r("option",{attrs:{value:""}},[e._v(e._s(e.noneText))]),e._v(" "),e._l(e.abuseReasons,function(t){return r("option",{key:t.id,domProps:{textContent:e._s(t.value)}})})],2)};o._withStripped=!0;var n={render:o,staticRenderFns:[]};t.a=n},104:function(e,t,r){"use strict";var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("h1",{staticClass:"wp-heading-inline"},[e._v(e._s(e.__("Abuse Reports","dokan")))]),e._v(" "),r("hr",{staticClass:"wp-header-end"}),e._v(" "),r("list-table",{attrs:{columns:e.columns,loading:e.loading,rows:e.reports,actions:e.actions,"bulk-actions":e.bulkActions,"total-items":e.totalItems,"total-pages":e.totalPages,"per-page":e.perPage,"current-page":e.currentPage},on:{pagination:e.goToPage,"bulk:click":e.onBulkAction},scopedSlots:e._u([{key:"reason",fn:function(t){var o=t.row;return[r("strong",[r("a",{attrs:{href:"#view-report"},on:{click:function(t){t.preventDefault(),e.showReport(o)}}},[e._v(e._s(o.reason))])])]}},{key:"product",fn:function(t){var o=t.row;return[r("a",{attrs:{href:o.product.admin_url}},[e._v(e._s(o.product.title))])]}},{key:"vendor",fn:function(t){var o=t.row;return[r("router-link",{attrs:{to:"/vendors/"+o.vendor.id}},[e._v("\n                "+e._s(o.vendor.name?o.vendor.name:e.__("(no name)","dokan"))+"\n            ")])]}},{key:"reported_by",fn:function(t){var o=t.row;return[o.reported_by.admin_url?r("a",{attrs:{href:o.reported_by.admin_url,target:"_blank"},domProps:{textContent:e._s(o.reported_by.name)}}):[e._v("\n                "+e._s(o.reported_by.name)+" <"+e._s(o.reported_by.email)+">\n            ")]]}},{key:"reported_at",fn:function(t){var r=t.row;return[e._v("\n            "+e._s(e.moment(r.reported_at).format("MMM D, YYYY h:mm:ss a"))+"\n        ")]}}])},[r("template",{slot:"filters"},[r("abuse-reasons-dropdown",{attrs:{placeholder:e.__("Filter by abuse reason","dokan")},model:{value:e.filter.reason,callback:function(t){e.$set(e.filter,"reason",t)},expression:"filter.reason"}}),e._v(" "),e.filter.reason?r("button",{staticClass:"button",attrs:{type:"button"},on:{click:function(t){e.filter.reason=""}}},[e._v("×")]):e._e(),e._v(" "),r("select",{staticStyle:{width:"190px"},attrs:{id:"filter-products","data-placeholder":e.__("Filter by product","dokan")}}),e._v(" "),e.filter.product_id?r("button",{staticClass:"button",attrs:{type:"button"},on:{click:function(t){e.filter.product_id=0}}},[e._v("×")]):e._e(),e._v(" "),r("select",{staticStyle:{width:"190px"},attrs:{id:"filter-vendors","data-placeholder":e.__("Filter by vendor","dokan")}}),e._v(" "),e.filter.vendor_id?r("button",{staticClass:"button",attrs:{type:"button"},on:{click:function(t){e.filter.vendor_id=0}}},[e._v("×")]):e._e()],1)],2),e._v(" "),e.showModal?r("modal",{attrs:{title:e.__("Product Abuse Report","dokan"),footer:!1},on:{close:e.hideReport}},[r("template",{slot:"body"},[r("p",{staticStyle:{"margin-top":"0"}},[r("strong",[e._v(e._s(e.__("Reported Product","dokan"))+":")]),e._v(" "),r("a",{attrs:{href:e.report.product.admin_url}},[e._v(e._s(e.report.product.title))])]),e._v(" "),r("p",[r("strong",[e._v(e._s(e.__("Reason","dokan"))+":")]),e._v(" "+e._s(e.report.reason))]),e._v(" "),r("p",[r("strong",[e._v(e._s(e.__("Description","dokan"))+":")]),e._v(" "+e._s(e.report.description||"―"))]),e._v(" "),r("p",[r("strong",[e._v(e._s(e.__("Reported by","dokan"))+":")]),e._v(" "),e.report.reported_by.admin_url?r("a",{attrs:{href:e.report.reported_by.admin_url,target:"_blank"},domProps:{textContent:e._s(e.report.reported_by.name)}}):[e._v("\n                    "+e._s(e.report.reported_by.name)+" <"+e._s(e.report.reported_by.email)+">\n                ")]],2),e._v(" "),r("p",[r("strong",[e._v(e._s(e.__("Reported At","dokan"))+":")]),e._v(" "+e._s(e.moment(e.report.reported_at).format("MMM D, YYYY h:mm:ss a")))]),e._v(" "),r("p",[r("strong",[e._v(e._s(e.__("Product Vendor","dokan"))+":")]),e._v(" "),e.report.vendor.admin_url?r("a",{attrs:{href:e.report.vendor.admin_url},domProps:{textContent:e._s(e.report.vendor.name)}}):[e._v("\n                    "+e._s(e.report.reported_by.name)+" <"+e._s(e.report.reported_by.email)+">\n                ")]],2)])],2):e._e()],1)};o._withStripped=!0;var n={render:o,staticRenderFns:[]};t.a=n},30:function(e,t,r){"use strict";(function(e){var o=r(102),n=dokan_get_lib("ListTable"),s=dokan_get_lib("Modal"),a=dokan_get_lib("Multiselect");t.a={name:"AbuseReports",components:{AbuseReasonsDropdown:o.a,ListTable:n,Modal:s,Multiselect:a},data:function(){return{columns:{reason:{label:this.__("Reason","dokan")},product:{label:this.__("Product","dokan")},vendor:{label:this.__("Vendor","dokan")},reported_by:{label:this.__("Reported by","dokan")},reported_at:{label:this.__("Reported at","dokan")}},loading:!1,reports:[],actions:[],bulkActions:[{key:"delete",label:this.__("Delete","dokan")}],totalItems:0,totalPages:1,perPage:10,showModal:!1,report:{},query:{},filter:{reason:"",vendor_id:0,product_id:0}}},computed:{currentPage:function(){var e=this.$route.query.page||1;return parseInt(e)},queryFilterReason:function(){return this.$route.query.reason||""}},created:function(){this.queryFilterReason&&(this.filter.reason=this.queryFilterReason,this.query.reason=this.queryFilterReason),this.fetchReports()},mounted:function(){var t=this;e("#filter-products").selectWoo({ajax:{url:dokan.rest.root+"wc/v3/products",dataType:"json",headers:{"X-WP-Nonce":dokan.rest.nonce},data:function(e){return{search:e.term}},processResults:function(e){return{results:e.map(function(e){return{id:e.id,text:e.name}})}}}}),e("#filter-products").on("select2:select",function(e){t.filter.product_id=e.params.data.id}),e("#filter-vendors").selectWoo({ajax:{url:dokan.rest.root+"dokan/v1/stores",dataType:"json",headers:{"X-WP-Nonce":dokan.rest.nonce},data:function(e){return{search:e.term}},processResults:function(e){return{results:e.map(function(e){return{id:e.id,text:e.store_name}})}}}}),e("#filter-vendors").on("select2:select",function(e){t.filter.vendor_id=e.params.data.id})},watch:{"$route.query.page":function(){this.fetchReports()},"$route.query.reason":function(){this.fetchReports()},"$route.query.product_id":function(){this.fetchReports()},"$route.query.vendor_id":function(){this.fetchReports()},"filter.reason":function(e){this.query={},e&&(this.query={reason:e}),this.goTo(this.query)},"filter.product_id":function(e){e?this.query.product_id=e:this.query.product_id&&(delete this.query.product_id,this.clearSelection("#filter-products")),this.goTo(this.query)},"filter.vendor_id":function(e){e?this.query.vendor_id=e:this.query.vendor_id&&(delete this.query.vendor_id,this.clearSelection("#filter-vendors")),this.goTo(this.query)}},methods:{fetchReports:function(){var e=this;e.loading=!0,e.currentPage>1&&(e.query.page=e.currentPage),dokan.api.get("/abuse-reports",e.query).done(function(t,r,o){e.reports=t,e.loading=!1,e.updatePagination(o)})},updatePagination:function(e){this.totalPages=parseInt(e.getResponseHeader("X-Dokan-AbuseReports-TotalPages")),this.totalItems=parseInt(e.getResponseHeader("X-Dokan-AbuseReports-Total"))},moment:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){return moment(e)}),goToPage:function(e){this.query.page=e,this.goTo(this.query)},goTo:function(e){this.$router.push({name:"AbuseReports",query:e})},showReport:function(e){this.report=e,this.showModal=!0},hideReport:function(){this.report={},this.showModal=!1},clearSelection:function(t){e(t).val(null).trigger("change")},onBulkAction:function(e,t){var r=this;confirm(this.__("Are you sure you want to delete this report","dokan"))&&dokan.api.delete("/abuse-reports/batch",{items:t}).done(function(e){r.fetchReports()})}}}}).call(t,r(1))},31:function(e,t,r){"use strict";t.a={name:"AbuseReasonsDropdown",props:{value:{type:String,required:!0},placeholder:{type:String,required:!1,default:""}},data:function(){return{abuseReasons:[]}},computed:{selectedReason:{get:function(){var e=this,t=this.abuseReasons.filter(function(t){return e.value===t.value});return t.length?t[0].value:""},set:function(e){this.$emit("input",e||"")}},noneText:function(){return this.placeholder||this.__("Select a reason","dokan")}},created:function(){this.fetchAbuseReasons()},methods:{fetchAbuseReasons:function(){var e=this;dokan.api.get("/abuse-reports/abuse-reasons").done(function(t){e.abuseReasons=t})}}}}});